%==============================================================================
% Documentation (pdflatex --interaction=nonstopmode this_file.spad
% Note: ensure that the code above is between \iffalse ... )if false\fi.
%==============================================================================
\documentclass[12pt,a4paper]{article}
\usepackage[utf8]{inputenc}
\usepackage[english]{babel}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{makeidx}
\usepackage{graphicx}
\usepackage{listings}
\usepackage{color}
\usepackage{epstopdf}

\definecolor{dkgreen}{rgb}{0,0.6,0}
\definecolor{gray}{rgb}{0.5,0.5,0.5}
\definecolor{mauve}{rgb}{0.58,0,0.82}
\definecolor{orange}{rgb}{1.0,0.44,0}

\lstdefinelanguage{SPAD}
{keywords={if,then,else,for,in,repeat},
keywords=[2]{Fraction, Integer, Polynomial, Expression, Float, 
             DoubleFloat, SurfaceComplex, CellMap, 
             List},
keywords=[3]{cellMap, bdry, tangentSpace, normalSpace, normalField,
             metricTensor},
keywordstyle=[2]\color{red},
keywordstyle=[3]\color{orange},
sensitive=true,%
alsoletter={\$},%
comment=[l]{--},%
string=[b]",%
string=[b]'%
}

\lstset{frame=tb,
  language=SPAD,
  aboveskip=3mm,
  belowskip=3mm,
  showstringspaces=false,
  columns=flexible,
  basicstyle={\small\ttfamily},
  numbers=none,
  numberstyle=\tiny\color{gray},
  keywordstyle=\color{blue},
  commentstyle=\color{dkgreen},
  stringstyle=\color{mauve},
  breaklines=true,
  breakatwhitespace=true,
  tabsize=3
}
\author{Kurt Pagani \\ {\tt nilqed@gmail.com}}
\date{\today}
\title{SurfaceComplex \\ {\small\tt Domain: SCMPLX}}
%
\newcommand{\CAD}{{\tt CAD}}
\newcommand{\QE}{{\tt QE}}
\newcommand{\RR}[1]{\mathbb{R}^{#1}}
\newcommand{\QQ}[1]{\mathbb{Q}^{#1}}
\newcommand{\ZZ}[1]{\mathbb{Z}^{#1}}
\newcommand{\KK}[1]{\mathbb{K}^{#1}}
\newcommand{\spadfun}[1]{\textcolor{magenta}{\tt #1}}
\newcommand{\spadbold}[1]{{\tt\bf #1}}
\newcommand{\type}[1]{\textcolor{blue}{\tt\tiny #1}}
\newtheorem{definition}{Definition}
%
\begin{document}
\maketitle
%
\begin{abstract}
This manual decribes the FriCAS domains {\bf CellMap} and 
{\bf SurfaceComplex}. These domains provide methods to compute
various differential geometric objects of so called $p$-surfaces
in ${\RR n}$, a notion which is used by Walter Rudin in his famous
{\it Principles of Mathematical Analysis}. 
\end{abstract}
%
\section{Introduction}
%
Dealing with manifolds or similar geometric structures in a scientific
computing system like FriCAS requires a great deal of abstraction as well
as some simplifications compared to the usual mathematical definitions of
such objects. It makes not much sense to speak of open sets, charts,
diffeomorphisms and other topological properties in this context. Of 
course, it is not impossible to mimic such terms in FriCAS, however,
it would be of little use since most of them were not computable
anyway. Since we already have differential forms and jet bundles at
hand, we are looking for {\it dual} objects, so that we will be able
to integrate differential forms over {\it surfaces} for example, that
is to have some form of {\em Stokes theorem}:
\begin{displaymath}
  \int_{M} d\,\omega = \int_{\partial M} \omega
\end{displaymath}   
The identity above holds for a wide range of objects $M$ and $\omega$,
and is - roughly speaking - the basis of geometric integration 
\cite{GIT} and/or geometric measure theory \cite{GMT}. The generalization
of Stokes theorem in those theories looks like
\begin{displaymath}
    \langle M,d\, \omega\rangle = \langle \partial M, \omega \rangle,
\end{displaymath}  
where the pairing $\langle\cdot,\cdot\rangle$ usually denotes a bilinear
mapping between so called {\em chains} and {\em co-chains}. In the 
approach \cite{GIT} by Whitney (and recently by Harrison \cite{JH}) the
chains $M$ are built by geometric primitives (e.g. polyhedral chains)
forming normed linear spaces (for various norms like {\em sharp} or
{\em flat}) whose duals are the corresponding Banach space of co-chains,
where it is not clear a priori that they represent differential forms 
(this can be shown under certain conditions and is a highly non-trivial
task). The other approach (as described by Federer \cite{GMT}) starts
from smooth differential forms and looks at the dual space, well known
as {\em DeRham Currents}. The whole theory is more or less a fruitful
generalization of Laurent Schwartz's concept of {\em distributions}.
In this context Stokes theorem holds by definition:
\begin{displaymath}
      T(d\,\omega) = \partial T (\omega),
\end{displaymath}
for all smooth forms and all currents (comparable to the derivatives
of distributions $T'(\varphi)=-T(\varphi')$). This means $\partial$ is
a linear operator (usually called {\em boundary operator}) which is
loosely speaking the transpose of the differential operator $d$.

Here we will follow along the lines of the latter approach, that is we
are going to deal with objects which might be seen as DeRham currents
in a wider sense, though we only consider {\em nice} objects (currents
form a really huge space and many elements look quite bizarre) which
have some relation to differential geometry.

There is, however, {\bf one notable difference} to the literature cited 
inasmuch as a differential form here is considered as an element of 
the graded algebra
\begin{displaymath}
  \bigoplus_{p=0}^n {\bf\Omega}^p(\RR n),
\end{displaymath}
whereas usually only homogeneous forms $\in\bf\Omega^p$
\footnote{$\Omega$ is a synonym for e.g. $\mathcal{D,E}$ etc.} 
are meant. This descends from the already existing domain 
{\em DeRhamComplex} on the one hand and computational convenience of 
such inhomogeneous forms on the other. So we have for instance
\begin{displaymath}
   \omega(x) = a(x)\,d\,x_1+b(x)\, dx_1\wedge dx_2,
\end{displaymath} 
which is neither a $1$-form nor a $2$-form but just a form. If we 
speak of a $p$-form we always mean a homogeneous form otherwise we
just speak of a {\em form}. This also is a reason why we speak of
a {\em complex}.
%
\section{$p-$Surfaces}
From a computational point of view it seems very convenient to follow
the method in (\cite{PMA},chapter 10) how differential forms are 
introduced. We will not copy here parts of that theory but merely
state the most important definitions on which the {\em code} will be
based.
%
\begin{definition}
A subset of ${\RR p}$ of the form
  \begin{displaymath}
    \{\left(x_1,\ldots,x_p\right)\in {\RR p}: 
       a_i \leq x_i \leq b_i, i=1,\ldots,p\}
  \end{displaymath} 
is called a $\bf p-${\bf cell}.
\end{definition}
%
Usually $p>1$ and $a_i<b_i$, but we will allow $p=0$ and $a_j=b_j$ as
a degenerate case (we will come back to this later on).
%
\begin{definition}
Suppose $E$ is an open set in $\RR n$. A $\bf p-${\bf surface} in $E$
is a $\mathcal{C}^1-$mapping $\Phi$ from a compact set $D\subset\RR p$
into $\RR n$.

$D$ is called the parameter domain of $\Phi$.
\end{definition}
%
In the following we will tacitly assume that $D$ is some $p-$cell. 
This entails no loss of generality as pointed out in \cite{PMA} too. 
One important thing we will cite (\cite{PMA}, def. 10.10) here is:
\begin{verse}
We stress that $p-$surfaces in $E$ are defined to be mappings into $E$, 
not subsets of $E$. This agrees with our earlier definition of curves 
(Definition 6.26). In fact, $1-$surfaces are precisely the same as 
continuously differentiable curves. 
\end{verse}
%
In FriCAS there is no $\RR n$, not to speak of an open set $E$. Instead
of we will use the (pseudo-) Field {\em Expression R}, where is a 
{\em Ring} with some additional properties (usually $R=\mathbb Z)$.
Therefore points in $\RR n$ would correspond to
\begin{lstlisting}
x:List Expression Integer:=[x[1],...,x[n]]
-- or
y:Vector Expression Integer:=[y[1],...,y[n]]
-- x <-> easy convertibe 
\end{lstlisting}
and $p-$cells will be represented by a list of segments
\begin{lstlisting}
Q:List Segment Expression Integer:=[a[1]..b[1],...,a[p]..b[p]] 
\end{lstlisting}
Instead of {\tt Integer} one might use {\tt Float} of course. This
way we have a correspondence to the definitions given above as soon we
fix how the mappings from $Q$ to $E$ looks like. Obviously we can
emulate $E$ as lists of length $n$ of a suitable type, thus our 
mapping $\Phi$ (P below) can be given by the $\lambda$ expression: 
\begin{lstlisting}
X+->[P[1](X.1,...,X.p),...,P[n](X.1,...,X.p)]
\end{lstlisting}
where $X=X.1,...,X.p$ ranges over the $p-$cell $Q$. 

We will call a $p-$surface in FriCAS a {\em CellMap}. This because it 
shall remind to the domain (a $p-$cell) on the one hand and to the fact 
that it is a mapping (and not a set) on the other hand. As an example
we construct a $1-$surface (a curve) in three space as follows:
\begin{lstlisting}
cellMap([0..6],x+->[cos x.1, sin x.1, x.1])$CellMap(Float,3)
\end{lstlisting} 
\begin{verbatim}
            |[0.0..6.0] -> [cos($ ),sin($ ),$ ]|
                                 1       1   1                                     
\end{verbatim}
\type{Type:CellMap(Float,3)}

\input{fig1}

Notice that domain variable ($x$ in the case above) is a list with the
dimension of the cell ($1-$cell in the example), therefore the (only)
parameter is {\tt x.1}. Further note that $x$ is just a dummy variable,
we could have chosen any other symbol as well, so that a {\em CellMap}
is independent of the coordinate symbol - which is also indicated by
the $\$'s$ in the output format. One has to apply the mapping to a 
point in order to get a point on the {\it surface}.
%
\subsection{Integration over $p-$Surfaces}
Let $\omega$ be a general $p-$form in $\RR n$:
\begin{displaymath}
   \omega(u) = \sum_{I} \omega_{i_1,\ldots,i_p}(u)\ du_{i_1}
   \wedge\ldots\wedge du_{i_p}
\end{displaymath}
then the integral of $\omega$ over a $p-$surface $\Phi$ is defined as
\begin{displaymath}
 \int_{\Phi} \omega = \int_{Q} 
   \sum_{I} \omega_{i_1,\ldots,i_p}(\Phi(x))
   \ \frac{\partial{(u_{i_1},\ldots,u_{i_p}})}{\partial{(x_1,\ldots,x_p})}
   \ dx_{1} \cdots dx_{p} 
\end{displaymath}
where $Q$ denotes the parameter domain of $\Phi$ (a $p-$cell in FriCAS).
The functions $\omega_{i_1,\ldots,i_p}$ are assumed to be real and
continuous and the {\em Jacobian} in the right hand side integral above
is the one determined by the mapping
\begin{displaymath}
     (x_1,\ldots,x_p) \mapsto (\Phi_{i_1}(x),\ldots,\Phi_{i_p}(x)),
\end{displaymath} 
which will be assumed to be continuously differentiable. Consequently
the integral is an ordinary Riemann integral over a hypercube in $\RR p$.
This widely corresponds to the statements given in \cite{PMA}. The
reader acquainted with the topic will immediately see that this is just
integration of the pull back of $\omega$ by $\Phi$ over its ($\Phi's$) 
domain:
\begin{displaymath}
    \int_{\Phi(Q)} \omega = \int_{Q} \Phi^{\star}\omega
\end{displaymath}
This and more will be rigorously proved in \cite{PMA}, so we will end
here with the theory and refer to the references given at the end.
%
\section{Surface Complex}
A cell map may be seen as a piece of a bigger object, comparable to 
a chart of a manifold which needs a whole atlas for its description.
Since we have assumed that the domains of cell maps are compact we
have a boundary $\partial Q$ which is built of of cells of one 
lower dimension. In other words, a $p-$surface $\Phi$ has a boundary
as well ($\partial \Phi$) which can be seen as a formal sum of other
cell maps. Similar as the domain {\tt DeRhamComplex} we define the
domain {\tt SurfaceComplex} as the free abelian group of cell maps
over $\mathbb{Z}$. This will enable us to define a 
{\em boundary operator}.
\begin{definition}
Let $\Sigma_p({\RR n})$ denote the set of $p-$surfaces, then 
the formal sums of these (with integer coefficients) build a
surface complex.
 \begin{displaymath}
  \mathcal{SC}_n=\bigoplus_{p=0}^n \mathbb{Z}\cdot\,{\bf\Sigma}_p ({\RR n}),
 \end{displaymath}
The boundary operator then is well defined
 \begin{displaymath}
   \partial: \mathcal{SC}_n \rightarrow \mathcal{SC}_n,
 \end{displaymath}
by the identity
  \begin{displaymath}
       \int_{\partial \Phi} \omega = \int_{\Phi} d\,\omega.
  \end{displaymath}
and the classical boundary of chains (simplexes in $\RR n$).
\end{definition}
The last statement probably should be specified. Let $a,b\in\RR p$, 
then the line segment $[a,b]$ (the convex hull of the two points)
induces a $1-current$ in a natural way:
\begin{displaymath}
   [[a,b]](\omega) = \int_0^1 \langle \omega((1-t)a+t + t b),b-a\rangle dt
\end{displaymath} 
for any one form $\omega\in\mathcal{D}^1({\RR p})$
\footnote{See \cite{GMT},4.1.8 for details}. If $\omega$ is exact 
(say $d\varphi$) we get
\begin{displaymath}
   [[a,b]](d\varphi) = 
     \int_0^1 \langle \nabla\varphi((1-t)a+t + t b),b-a\rangle dt =
     \varphi(b) -\varphi(a).
\end{displaymath}
This means - by the definition $\partial T(\varphi)=T(d\varphi)$ -
\begin{displaymath}
  \partial [[a,b]] = [[b]] - [[a]],
\end{displaymath}
where $[[b]](\varphi)$ is the $0-$current $\delta_b$, that is
$[[b]](\varphi)=\varphi(b)$ for all $0-$forms. This way it can 
be shown (by induction) that the boundary of a $p-$cell is given
by the formula:
\begin{eqnarray*}
 \partial([[a_1,b_1]]\times\ldots\times[[a_p,b_p]]) = \sum_{k=1}^p\ 
 (-1)^k [[a_+,b_1]]\times\,\ldots\times[[a_{k-1},b_{k-1}]] \\ 
 \times([[b_k]] - [[a_k]])\times [[a_{k+1},b_{k+1}]]\times\ldots\times
 [[a_{p},b_{p}]].
\end{eqnarray*}
This is a $(p-1)-$current which obviously coincides
with the usual geometric intuition (one may think of any $p-$cell as
a simplicial chain). We have used this formula to implement the boundary
operator ({\tt bdry}). 
%
\section{Implementation}
First we will describe the exported functions of the domain
{\tt CellMap}. The choice of the name may be debatable, however,
{\em ParametricSurface} and other suitable names are already taken.
For the other domain, {\tt SurfaceComplex}, we think it is an 
adequate designator what it is for.
\subsection{Domain: {\tt CellMap (CMAP)}}
lorem...
%\begin{figure}[!htb]
%\centering
%\includegraphics[scale=1.0]{cad1.eps}
%\caption{Example 1.}
%\label{fig:cad1}
%\end{figure}
% 
\begin{thebibliography}{1}
%
\bibitem{PMA} Walter Rudin,
  {\em Principles of Mathematical Analysis},
  International series in pure and applied mathematics,
  1976, McGraw-Hill.
\bibitem{GIT} Hassler Whitney. {\em Geometric Integration Theory},
  Princeton Mathematical Series, No. 21. Literary Licensing, LLC.
\bibitem{GMT} Herbert Federer. {\em Geometric Measure Theory}. Springer,        
  Reprint of the 1st ed. Berlin, Heidelberg, New York 1969 edition.
\bibitem{JH} Jenny Harrison, {\em Operator Calculus of Differential
  Chains and Differential Forms}, to appear in the Journal of Geometric
  Analysis, 2013. \\
  Url:\ {\small {\tt math.berkeley.edu/\textasciitilde harrison}}
\end{thebibliography}
%
\end{document}
% -----------------------------------------------------------------------------
% END DOCUMENTATION
% -----------------------------------------------------------------------------
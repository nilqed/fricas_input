--Copyright The Numerical Algorithms Group Limited 1994.
)set break resume
)expose UnittestCount UnittestAux Unittest
testsuite "prime?$Integer"
testcase "strong pseudoprimes"
testFactor(l: List Integer): Void ==
    free n
    n := reduce(*, l)
    s := delete(reduce(concat, _
                       [concat ["* primeFactor(", string f, ",1)"] _
                        for f in l]), 1)

    testTrue("not prime? n")
    testEquals("factor(n)", s)


--The first two (2152302898747 and 3474749660383) are the only strong
--pseudoprimes bases 2,3,5,7,11 less than 10^13: the remaining three
--are the only Carmichael numbers less than 10^16 with this property.
testFactor [6763, 10627, 29947]
testFactor [1303, 16927, 157543]
testFactor [3739, 18691, 153259]
testFactor [46411, 232051, 417691]
testFactor [21319, 106591, 3005839]

testcase "negative integers"
testTrue("prime?(-5)")
testTrue("not prime?(-15)")

testcase "Davenport Primality Testing Revisited"
-- Jaeschke
testTrue("not prime?(137716125329053 * 413148375987157)")
-- Arnault (k+1)(2k+1)
testTrue("not prime?(24444516448431392447461 * 48889032896862784894921)")

testcase "Zhenxiang Zhang, Two kinds of strong pseudoprimes up to 10^36"
-- Math. Comp.  76  (2007),  no. 260, 2095--2107

Table1 := [1543267864443420616877677640751301,
           3573966164315688081500989037680081,_
           3957570300351944936545806366050221,_
           7434112337530311731294137656793141,_
           11068905075460890469451728340323501,_
           15837769490890427362080539697619981,_
           28474734069948658439948497717356181,_
           40367254714218826380279781659656101,_
           71361969427913804551298969198134381,_
           82824364075160891096445017152530181,_
           88957815149805554548986624679089781,_
           155559415576705971544442260241085421,_
           179574770201988665981898462279223261,_
           194375577640515630021542270534335741,_
           219337010339607890908194166878591181,_
           252100580001725274015376769069176741,_
           255173558983450077412120850955148501,_
           407387351326298070201483525504009841,_
           527946434214347171361929671021353301,_
           534925558491481798612709096229028021,_
           808460124355439022735025127668137421,_
           812968039437255274477328666971353901,_
           816345937837238810402166547264426261,_
           964006870224361626772797038309214301];

testTrue("not any?(prime?, Table1)")

Table3 := [168790877523676911809192454171451,_
           404006419196517352340186908176331,_
           638448294554274988128326408678791,_
           7386491959322896977412581863267131,_
           14987066152476389521373597949057667,_
           22072884304282812126783178400582551,_
           22237516761876676325875933714505851,_
           22535137585571582393575508859041539,_
           33197805689160640280977000730295751,_
           73956318488637465060479221079709511,_
           84699940865376876461361355974527971,_
           86114946224343991256730573290132851,_
           157909679385259051550191589707564171,_
           164290818021112438861652311523405671,_
           329688822383744772420052773006657151,_
           381295376196063449827518388463105491,_
           488694766114162789165236319667944651,_
           615953281715442032393107126795194451,_
           663871524013514481984275366839039183,_
           678033047702587416969292603094702251];

testTrue("not any?(prime?, Table3)")

Proposition1dot1 := [1287836182261 * 2575672364521,_
                     54786377365501 * 109572754731001,_
                     172157429516701 * 344314859033401,_
                     531099297693901 * 1062198595387801,_
                     27778299663977101 * 55556599327954201];

testTrue("not any?(prime?, Proposition1dot1)")

-- Conjecture 1
xftestTrue("not prime?(149491 * 747451 * 34233211)")

-- Conjecture 2
testTrue("not prime?(399165290221 * 798330580441)")

statistics()
